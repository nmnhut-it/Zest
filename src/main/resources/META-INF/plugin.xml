<idea-plugin>
    <!-- Plugin name displayed in the IDE -->
    <!-- Read more: https://plugins.jetbrains.com/docs/marketplace/plugin-overview-page.html#plugin-name -->
    <name>Zest</name>
    
    <!-- Unique identifier of the plugin. It should be FQN. It cannot be changed between the plugin versions. -->
    <id>com.zps.Zest</id>
    
    <!-- Plugin version -->
    <version>1.9.910</version>

    <!-- Vendor information -->
    <vendor email="nhutnm3@vng.com.vn" url="https://www.vng.com.vn">Zingplay Game Studio</vendor>
    <!-- Plugin description -->
    <description><![CDATA[
   <h2>Zest: Smarter Java Development with AI</h2>
   <p><b>Zest</b> supercharges your IntelliJ workflow. Instantly generate JUnit tests, implement TODOs, and refactor for testability‚Äîall powered by AI. Enjoy one-click code reviews, auto-generated commit messages, and smart comments. Boost productivity, ship quality code, and let Zest handle the repetitive stuff so you can focus on building great software. Try Zest and make testing effortless.</p>]]></description>
    
    <!-- Compatibility version range -->
    <!-- Read more: https://plugins.jetbrains.com/docs/intellij/plugin-compatibility.html -->
    <depends>com.intellij.modules.platform</depends>
    <depends>com.intellij.java</depends>
    <depends>org.jetbrains.plugins.terminal</depends>
    <idea-version since-build="223.0" until-build="259.*"/>
    
    <projectListeners>
        <listener class="com.zps.zest.inlinechat.JCefInitializer"
                  topic="com.intellij.openapi.startup.ProjectActivity"/>
        <listener class="com.zps.zest.qwen.QwenConfigurationProjectListener"
                  topic="com.intellij.openapi.project.ProjectManagerListener"/>
    </projectListeners>

    <!-- Read more: https://plugins.jetbrains.com/docs/intellij/plugin-extension-points.html -->
    <extensions defaultExtensionNs="com.intellij">
        <!-- Application-level service for global settings -->
        <applicationService serviceImplementation="com.zps.zest.settings.ZestGlobalSettings"/>

        <!-- MCP Tool Server Service -->
        <applicationService serviceImplementation="com.zps.zest.mcp.ZestMcpToolServerService"/>

        <!-- Tool API Server Service (OpenWebUI integration) -->
        <projectService serviceImplementation="com.zps.zest.mcp.ToolApiServerService"/>

        <!-- Project-level service for project-specific settings -->
        <projectService serviceImplementation="com.zps.zest.settings.ZestProjectSettings"/>
        <!-- Using backgroundPostStartupActivity for better performance -->
        <backgroundPostStartupActivity implementation="com.zps.zest.mcp.ZestMcpToolServerStartupActivity"/>
        <backgroundPostStartupActivity implementation="com.zps.zest.mcp.ToolApiServerStartupActivity"/>
        <backgroundPostStartupActivity implementation="com.zps.zest.completion.ZestCompletionStartupActivity"/>
        <backgroundPostStartupActivity implementation="com.zps.zest.codehealth.CodeGuardianStartupActivity"/>
        <backgroundPostStartupActivity implementation="com.zps.zest.settings.SettingsMigrationNotice"/>
        <backgroundPostStartupActivity implementation="com.zps.zest.startup.PromptMigrationStartupActivity"/>
        <backgroundPostStartupActivity implementation="com.zps.zest.update.VersionUpdateNotifier"/>
        <backgroundPostStartupActivity implementation="com.zps.zest.testgen.snapshot.SnapshotCleanupActivity"/>
        <editorFactoryListener implementation="com.zps.zest.events.ZestEditorFactoryListener"/>
        <actionPromoter order="first" implementation="com.zps.zest.completion.actions.ZestActionPromoter"/>

                    

            
        <projectConfigurable
                groupId="tools"
                instance="com.zps.zest.settings.ZestSettingsConfigurable"
                displayName="Zest Plugin"
                id="zest.settings"
                nonDefaultProject="true"/>

                
        <projectConfigurable
                instance="com.zps.zest.codehealth.CodeHealthConfigurable"
                displayName="Code Health"
                id="zest.codeguardian"
                parentId="zest.settings"
                nonDefaultProject="true"/>

        <notificationGroup id="Zest LLM" displayType="BALLOON" toolWindowId="Terminal" isLogByDefault="false"/>
        <notificationGroup id="Code Health" displayType="BALLOON" toolWindowId="Terminal" isLogByDefault="false"/>
        <notificationGroup id="Zest Completion Debug" displayType="BALLOON" isLogByDefault="false"/>
        <notificationGroup id="Zest Updates" displayType="BALLOON" isLogByDefault="false"/>


        <!-- Status Bar Widgets -->
        <statusBarWidgetFactory id="ZestCompletionStatus" 
                               implementation="com.zps.zest.completion.ui.ZestCompletionStatusBarWidgetFactory" 
                               order="last"/>
        <statusBarWidgetFactory id="CodeHealthStatusBarWidget" 
                               implementation="com.zps.zest.codehealth.ui.CodeGuardianStatusBarWidgetFactory" 
                               order="last"/>

        
        <!-- Code Health Notification Group -->
        <notificationGroup id="Zest Code Health" displayType="BALLOON" isLogByDefault="false"/>
        
        <!-- Code Health Editor Provider -->
        <fileEditorProvider implementation="com.zps.zest.codehealth.ui.editor.CodeHealthEditorProvider"/>
        

        
        <!-- Zest Chat Editor Provider -->
        <fileEditorProvider implementation="com.zps.zest.browser.editor.ZestChatEditorProvider"/>
        
        <!-- Test Generation Editor Provider -->
        <fileEditorProvider implementation="com.zps.zest.testgen.ui.TestGenerationFileEditorProvider"/>
        

        <!-- LangChain4j Services for agentic retrieval and AI task management -->
        <projectService serviceImplementation="com.zps.zest.langchain4j.ZestLangChain4jService"/>
        <projectService serviceImplementation="com.zps.zest.langchain4j.naive_service.NaiveStreamingLLMService"/>
        <projectService serviceImplementation="com.zps.zest.retrieval.core.EmbeddingService"/>
        
        <!-- Test Generation Service -->
        <projectService serviceImplementation="com.zps.zest.testgen.StateMachineTestGenerationService"/>
        
        <!-- Chat UI Service -->
        <projectService serviceImplementation="com.zps.zest.chatui.ChatUIService"/>

        <!-- Browser Services -->
        <projectService serviceImplementation="com.zps.zest.browser.JCEFBrowserService"/>

        <!-- Inline Completion Services -->
        <projectService serviceImplementation="com.zps.zest.completion.ZestInlineCompletionService"/>

        <!-- Continue.dev MCP Configuration Service -->
        <projectService serviceImplementation="com.zps.zest.continuedev.ContinueConfigurationService"/>

        <!-- Code Health v2 Display Service -->
        <projectService serviceImplementation="com.zps.zest.codehealth.v2.intellij.CodeHealthDisplayService"/>
    </extensions>
    
    <actions>
        <group id="Zest.InlineCompletion" text="Zest Inline Completion">
            <action id="Zest.InlineCompletion.Trigger"
                    class="com.zps.zest.completion.actions.ZestTrigger"
                    text="Trigger Inline Completion / G·ª£i √Ω code th√¥ng minh"
                    description="Trigger smart code suggestions at cursor position / G·ª£i √Ω code th√¥ng minh t·∫°i v·ªã tr√≠ con tr·ªè">
                <keyboard-shortcut first-keystroke="ctrl alt SPACE" keymap="$default"/>

            </action>

            <action id="Zest.InlineCompletion.TabAccept"
                    class="com.zps.zest.completion.actions.ZestTabAccept"
                    text="Accept Completion (Tab) / Ch·∫•p nh·∫≠n g·ª£i √Ω (Tab)"
                    description="Accept suggestion with Tab key / Ch·∫•p nh·∫≠n g·ª£i √Ω b·∫±ng ph√≠m Tab">
                <keyboard-shortcut first-keystroke="TAB" keymap="$default"/>
            </action>

            <!-- Temporarily disabled - needs reimplementation
            <action id="Zest.InlineCompletion.Accept"
                    class="com.zps.zest.completion.actions.ZestAccept"
                    text="Accept Completion"
                    description="Ch·∫•p nh·∫≠n g·ª£i √Ω b·∫±ng Ctrl+Tab">
                <keyboard-shortcut first-keystroke="ctrl TAB" keymap="$default"/>
            </action>
            -->

            <!-- Temporarily disabled - needs reimplementation
            <action id="Zest.InlineCompletion.CycleNext"
                    class="com.zps.zest.completion.actions.ZestCycleNext"
                    text="Cycle Next Completion"
                    description="Xem g·ª£i √Ω ti·∫øp theo (Alt+Down)">
                <keyboard-shortcut first-keystroke="alt DOWN" keymap="$default"/>
            </action>

            <action id="Zest.InlineCompletion.CyclePrevious"
                    class="com.zps.zest.completion.actions.ZestCyclePrevious"
                    text="Cycle Previous Completion"
                    description="Xem g·ª£i √Ω tr∆∞·ªõc ƒë√≥ (Alt+Up)">
                <keyboard-shortcut first-keystroke="alt UP" keymap="$default"/>
            </action>
            -->

            <action id="Zest.InlineCompletion.Dismiss"
                    class="com.zps.zest.completion.actions.ZestDismiss"
                    text="Dismiss Completion / H·ªßy b·ªè g·ª£i √Ω"
                    description="Cancel suggestion with Escape / H·ªßy g·ª£i √Ω b·∫±ng ph√≠m Escape">
                <keyboard-shortcut first-keystroke="ESCAPE" keymap="$default"/>
            </action>

            <action id="Zest.TriggerQuickAction"
                    class="com.zps.zest.completion.actions.ZestTriggerQuickAction"
                    text="Quick Action... / Thao t√°c nhanh..."
                    description="Perform specific task on selected code / Th·ª±c hi·ªán t√°c v·ª• c·ª• th·ªÉ tr√™n code ƒë√£ ch·ªçn">
                <keyboard-shortcut first-keystroke="ctrl SPACE" keymap="$default"/>
                <keyboard-shortcut first-keystroke="ctrl SPACE" keymap="Mac OS X"/>
                <keyboard-shortcut first-keystroke="ctrl SPACE" keymap="Mac OS X 10.5+"/>
            </action>

        </group>

        <group id="ZestGroup" text="Zest" description="AI-powered tools for development / C√¥ng c·ª• AI h·ªó tr·ª£ l·∫≠p tr√¨nh" popup="true"
               icon="com.zps.zest.ZestIcons.ZEST">
            <add-to-group group-id="EditorPopupMenu" anchor="first"/>
        </group>
        
        <!-- Simple Chat Dialog Action -->
<!--        <action id="Zest.OpenSimpleChat"-->
<!--                class="com.zps.zest.chatui.OpenChatDialogAction"-->
<!--                text="üí¨ Open Chat - Simple / M·ªü h·ªôp tho·∫°i chat trong Intelij"-->
<!--                description="Open simple chat dialog for AI assistance / M·ªü h·ªôp tho·∫°i chat ƒë∆°n gi·∫£n v·ªõi AI">-->
<!--            <add-to-group group-id="ZestGroup" anchor="first"/>-->
<!--        </action>-->
        
        <!-- Open Chat in Editor Action -->
        <action id="Zest.OpenChatInEditor"
                class="com.zps.zest.browser.actions.OpenChatInEditorAction"
                text="Open Chat / M·ªü chat to√†n m√†n h√¨nh"
                description="Open ZPS Chat in full-screen editor tab / M·ªü chat AI trong tab to√†n m√†n h√¨nh">
            <add-to-group group-id="ZestGroup" anchor="first"/>
        </action>



        <!-- Toolbar Actions -->
        <action id="Zest.OpenChat"
                class="com.zps.zest.browser.actions.OpenZestChatAction"
                text="Chat / Tr√≤ chuy·ªán v·ªõi AI"
                icon="com.zps.zest.ZestIcons.ZPS_CHAT"
                description="Open ZPS AI Chat / M·ªü c·ª≠a s·ªï tr√≤ chuy·ªán v·ªõi AI">
            <add-to-group group-id="MainToolbarRight" anchor="last"/>
            <keyboard-shortcut keymap="$default" first-keystroke="ctrl shift C"/>
        </action>

        <action id="Zest.OpenCodeHealth"
                class="com.zps.zest.codehealth.actions.OpenCodeHealthAction"
                text="Health / Ki·ªÉm tra s·ª©c kh·ªèe code"
                icon="com.zps.zest.ZestIcons.CODE_HEALTH"
                description="Open Code Health Overview / M·ªü b·∫£ng ki·ªÉm tra ch·∫•t l∆∞·ª£ng code">
            <add-to-group group-id="MainToolbarRight" anchor="after" relative-to-action="Zest.OpenChat"/>
        </action>

        <action id="Zest.SendCodeReviewToChatBox"
                class="com.zps.zest.browser.actions.SendCodeReviewToChatBox"
                text="Code Review (Chat) / Nh·ªù AI xem code"
                icon="com.zps.zest.ZestIcons.ZPS_CHAT_16"
                description="AI reviews and suggests improvements / AI xem x√©t code v√† ƒë∆∞a ra g·ª£i √Ω c·∫£i thi·ªán">
            <add-to-group group-id="ZestGroup" anchor="last"/>
            <add-to-group group-id="EditorPopupMenu" anchor="after" relative-to-action="Zest.ReviewCurrentFile"/>
        </action>

        <action id="Zest.GitCommitMessageGeneratorAction"
                class="com.zps.zest.GitCommitMessageGeneratorAction"
                text="Git Commit and Push / L∆∞u v√† ƒë·∫©y code l√™n Git"
                icon="com.zps.zest.ZestIcons.ZPS_CHAT_16"
                description="Open Git UI with AI-generated commit message / M·ªü giao di·ªán Git v·ªõi AI t·ª± ƒë·ªông vi·∫øt m√¥ t·∫£ commit">
            <add-to-group group-id="ZestGroup" anchor="last"/>
        </action>



        <!-- Removed Start Tools action - proxy server is now controlled via settings -->
        
        <!-- Test Generation Action -->
        <action id="Zest.GenerateTests"
                class="com.zps.zest.testgen.actions.GenerateTestAction"
                text="Generate Tests (AI) / T·∫°o test t·ª± ƒë·ªông"
                icon="com.zps.zest.ZestIcons.TEST_WRITING_16"
                description="Generate tests using AI agents / D√πng AI ƒë·ªÉ vi·∫øt test cho code c·ªßa b·∫°n">
            <add-to-group group-id="ZestGroup" anchor="last"/>
            <add-to-group group-id="EditorPopupMenu" anchor="after" relative-to-action="Generate"/>
            <keyboard-shortcut first-keystroke="ctrl alt T" keymap="$default"/>
        </action>

        <!-- Test Generation Help Action -->
        <action id="Zest.ShowTestGenerationHelp"
                class="com.zps.zest.testgen.actions.ShowTestGenerationHelpAction"
                icon="AllIcons.Actions.MoveToWindow"
                text="Test Generation Guide / H∆∞·ªõng d·∫´n t·∫°o test"
                description="View comprehensive test generation documentation / Xem t√†i li·ªáu chi ti·∫øt v·ªÅ t·∫°o test">
            <add-to-group group-id="ZestGroup" anchor="after" relative-to-action="Zest.GenerateTests"/>
        </action>

        <!-- Snapshot Manager Action -->
        <action id="Zest.OpenSnapshotManager"
                class="com.zps.zest.testgen.actions.OpenSnapshotManagerAction"
                text="Manage Test Generation Snapshots / Qu·∫£n l√Ω snapshot test"
                description="View, resume, and manage saved test generation checkpoints / Xem, ti·∫øp t·ª•c v√† qu·∫£n l√Ω c√°c checkpoint ƒë√£ l∆∞u">
            <add-to-group group-id="ZestGroup" anchor="after" relative-to-action="Zest.ShowTestGenerationHelp"/>
        </action>

        <!-- Batch Test Generation Action -->
        <action id="Zest.BatchTestGeneration"
                class="com.zps.zest.testgen.batch.BatchTestGenerationAction"
                text="Batch Test Generation (Evaluation) / T·∫°o test h√†ng lo·∫°t"
                description="Generate tests for multiple files to evaluate feature effectiveness / T·∫°o test cho nhi·ªÅu file ƒë·ªÉ ƒë√°nh gi√° hi·ªáu qu·∫£">
            <add-to-group group-id="ToolsMenu" anchor="last"/>
        </action>

        <action id="Zest.TestContextSummarization"
                class="com.zps.zest.testgen.actions.TestContextSummarizationAction"
                text="üß™ Test Context Summarization"
                description="Test the context summarization system with real classes">
            <add-to-group group-id="ToolsMenu" anchor="last"/>
        </action>

        <!-- Code Health Group -->
        <group id="Zest.CodeHealth" text="Code Health / S·ª©c kh·ªèe code" popup="true">
            <add-to-group group-id="ZestGroup" anchor="last"/>
            <!-- Removed from ToolsMenu - available in ZestGroup -->
            
            <!-- Removed non-functional "Activate Code Health" action -->
            
<!--            <action id="Zest.AddMethodAtCaret"-->
<!--                    class="com.zps.zest.codehealth.actions.AddMethodAtCaretAction"-->
<!--                    text="üéØ Track This Method / Theo D√µi Method N√†y"-->
<!--                    description="Add method to quality monitoring queue / Th√™m method v√†o h√†ng ƒë·ª£i gi√°m s√°t ch·∫•t l∆∞·ª£ng">-->
<!--            </action>-->
            
<!--            <action id="Zest.TriggerBackgroundReview"-->
<!--                    class="com.zps.zest.codehealth.actions.TriggerBackgroundReviewAction"-->
<!--                    text="üîÑ Process Review Queue / X·ª≠ L√Ω H√†ng ƒê·ª£i"-->
<!--                    description="Review all pending methods in background / ƒê√°nh gi√° c√°c method ƒëang ch·ªù">-->
<!--            </action>-->

            <action id="Zest.ReviewCurrentFile"
                    class="com.zps.zest.codehealth.actions.ReviewCurrentFileAction"
                    text="Review This File Now / Ki·ªÉm tra file ngay"
                    description="Immediately analyze current file / Ph√¢n t√≠ch ngay file hi·ªán t·∫°i">
                <add-to-group group-id="EditorPopupMenu" anchor="after" relative-to-action="Zest.GenerateTests"/>
                <keyboard-shortcut first-keystroke="ctrl alt H" keymap="$default"/>
            </action>
            
            <action id="Zest.TriggerFinalReview"
                    class="com.zps.zest.codehealth.actions.TriggerFinalReviewAction"
                    text="üìä Daily Health Report / B√°o c√°o ch·∫•t l∆∞·ª£ng h√†ng ng√†y"
                    description="Generate comprehensive daily report / T·∫°o b√°o c√°o t·ªïng h·ª£p ch·∫•t l∆∞·ª£ng code h√†ng ng√†y">
            </action>
            <action id="Zest.ShowGuardianHelp"
                    class="com.zps.zest.codehealth.actions.ShowGuardianHelpAction"
                    text="Usage Guide / H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng"
                    description="View Code Health usage guide / Xem h∆∞·ªõng d·∫´n s·ª≠ d·ª•ng ki·ªÉm tra s·ª©c kh·ªèe code">
            </action>
        </group>

        <!-- Ripgrep Tool Testing Action -->
        <action id="Zest.TestRipgrepTool"
                class="com.zps.zest.explanation.tools.testing.TestRipgrepToolAction"
                text="Test Ripgrep Tool / Ki·ªÉm tra c√¥ng c·ª• t√¨m ki·∫øm"
                description="Open manual testing dialog / M·ªü h·ªôp tho·∫°i ki·ªÉm th·ª≠ c√¥ng c·ª• t√¨m ki·∫øm code">
            <add-to-group group-id="ToolsMenu" anchor="last"/>
            <add-to-group group-id="CodeMenu" anchor="last"/>
            <keyboard-shortcut keymap="$default" first-keystroke="ctrl shift F12"/>
        </action>

        <!-- Code Context Agent Testing Action -->
        <action id="Zest.TestCodeContext"
                class="com.zps.zest.context.ui.TestCodeContextAction"
                text="Test Code Context Agent / Ki·ªÉm tra t√¨m hi·ªÉu ng·ªØ c·∫£nh code"
                description="Open test dialog for Code Context Agent / M·ªü h·ªôp tho·∫°i th·ª≠ nghi·ªám t√¨m hi·ªÉu code">
            <add-to-group group-id="ToolsMenu" anchor="last"/>
        </action>

        <!-- Metrics Testing Action -->
        <action id="Zest.TestMetrics"
                class="com.zps.zest.completion.metrics.testing.ui.TestMetricsAction"
                text="Test Metrics System / Ki·ªÉm tra h·ªá th·ªëng metrics"
                description="Open test dialog for Metrics System / M·ªü h·ªôp tho·∫°i th·ª≠ nghi·ªám metrics">
            <add-to-group group-id="ToolsMenu" anchor="last"/>
        </action>

        <!-- View Metrics Session Log Action -->
        <action id="Zest.ViewMetricsSession"
                class="com.zps.zest.completion.metrics.testing.ui.ViewMetricsSessionAction"
                text="View Metrics Session Log / Xem log session metrics"
                description="View complete session log of all metrics events / Xem log ƒë·∫ßy ƒë·ªß t·∫•t c·∫£ s·ª± ki·ªán metrics">
            <add-to-group group-id="ToolsMenu" anchor="last"/>
        </action>

        <!-- Code Health Debug Actions Group -->
        <group id="Zest.CodeHealthDebug" text="Debug Tools / C√¥ng c·ª• g·ª° l·ªói" popup="true">
<!--            <add-to-group group-id="Zest.CodeHealth" anchor="last"/>-->

            <action id="Zest.ShowReviewQueueStatus"
                    class="com.zps.zest.codehealth.actions.ShowReviewQueueStatusAction"
                    text="Review Queue Status / Xem danh s√°ch ch·ªù ki·ªÉm tra"
                    description="View methods being monitored / Xem c√°c ph∆∞∆°ng th·ª©c ƒëang ƒë∆∞·ª£c theo d√µi">
            </action>
            
            <action id="Zest.DebugHealthAction"
                    class="com.zps.zest.codehealth.DebugHealthAction"
                    text="Test Mode / Ch·∫ø ƒë·ªô th·ª≠ nghi·ªám"
                    description="Reset and add test data / ƒê·∫∑t l·∫°i v√† th√™m d·ªØ li·ªáu th·ª≠ nghi·ªám">
            </action>
            
            <separator/>
            

        </group>
        
        <!-- Moved debug actions to a debug submenu -->
        
        <!-- Zest Rules Management Action -->
        <action id="Zest.CreateRulesFile"
                class="com.zps.zest.actions.CreateZestRulesAction"
                text="Create/Open Zest Rules File / T·∫°o/M·ªü file quy t·∫Øc"
                description="Create or open custom rules file / T·∫°o ho·∫∑c m·ªü file ƒë·ªãnh nghƒ©a quy t·∫Øc ri√™ng cho AI">
            <add-to-group group-id="ZestGroup" anchor="first"/>
        </action>

        <!-- Continue.dev MCP Setup Action -->
        <action id="Zest.SetupContinueMcp"
                class="com.zps.zest.continuedev.SetupContinueMcpAction"
                text="Install MCP for Continue.dev / C√†i MCP cho Continue.dev"
                description="Setup Zest MCP server config for Continue.dev (VS Code) / C√†i ƒë·∫∑t MCP server Zest cho Continue.dev">
            <add-to-group group-id="ZestGroup" anchor="last"/>
        </action>
        
        <!-- Open Chat in Editor (also in Tools menu) -->
        <action id="Zest.OpenChatInEditorTools"
                class="com.zps.zest.browser.actions.OpenChatInEditorAction"
                text="ZPS Chat (Editor) / Chat to√†n m√†n h√¨nh"
                description="Open ZPS Chat in full-screen editor tab / M·ªü chat AI ·ªü ch·∫ø ƒë·ªô to√†n m√†n h√¨nh">
<!--            <add-to-group group-id="ToolsMenu" anchor="last"/>-->
        </action>

        <!-- Tool-Enabled Chat Action -->
        <action id="Zest.OpenToolEnabledChat"
                class="com.zps.zest.browser.actions.OpenToolEnabledChatAction"
                text="Chat with Tools / Chat v·ªõi c√¥ng c·ª• m·∫°nh"
                description="Open chat with code exploration tools / M·ªü chat v·ªõi kh·∫£ nƒÉng t√¨m ki·∫øm v√† ph√¢n t√≠ch code">
<!--            <add-to-group group-id="ToolsMenu" anchor="last"/>-->
        </action>
        
        <!-- Zest Update Info Action -->
        <action id="Zest.ShowUpdateInfo"
                class="com.zps.zest.update.ShowUpdateInfoAction"
                text="Check for Zest Updates... / Ki·ªÉm tra c·∫≠p nh·∫≠t"
                description="Show update information / Hi·ªÉn th·ªã th√¥ng tin v√† t√πy ch·ªçn t·∫£i b·∫£n m·ªõi">
<!--            <add-to-group group-id="ToolsMenu" anchor="last"/>-->
        </action>

        <!-- Zest Debug Menu (only in Tools menu) -->
        <group id="Zest.DebugMenu" text="Zest Debug / G·ª° l·ªói Zest" popup="true">
<!--            <add-to-group group-id="ToolsMenu" anchor="last"/>-->
            
            <action id="Zest.ShowCompletionTimingDebug"
                    class="com.zps.zest.actions.ZestCompletionTimingDebugAction"
                    text="Completion Timing Debug... / Ki·ªÉm tra t·ªëc ƒë·ªô g·ª£i √Ω"
                    description="Show timing breakdown / Hi·ªÉn th·ªã ph√¢n t√≠ch th·ªùi gian g·ª£i √Ω code"/>
            
            <!-- Temporarily disabled - debug action removed
            <action id="Zest.ToggleCompletionDebug"
                    class="com.zps.zest.actions.ToggleCompletionDebugAction"
                    text="Toggle Completion Debug Logging"
                    description="Enable/disable verbose debug logging for completion"/>
            -->
            
            <action id="Zest.ToggleDevTools"
                    class="com.zps.zest.browser.actions.ToggleDevToolsAction"
                    text="Toggle Browser DevTools / B·∫≠t/t·∫Øt c√¥ng c·ª• debug"
                    description="Toggle developer tools / B·∫≠t/t·∫Øt c√¥ng c·ª• debug tr√¨nh duy·ªát chat"/>
                    

        </group>
    </actions>

    <!-- Change notes for version updates -->
    <change-notes><![CDATA[
        <h3>Version 1.9.910 - Dual Server Architecture & Complete Tool Integration üîå</h3>
        <h4>üõ†Ô∏è Enhanced MCP Tools (Qwen CLI)</h4>
        <ul>
            <li><b>analyzeMethodUsage Tool</b> - Discover real usage patterns, edge cases, and integration contexts from actual codebase usage</li>
            <li><b>getGitStatus Tool</b> - Retrieve git status showing modified, added, and deleted files</li>
            <li><b>getGitDiff Tool</b> - Get comprehensive git diff for all changed files in the project</li>
        </ul>

        <h4>üí¨ Intelligent MCP Prompts (Slash Commands)</h4>
        <ul>
            <li><b>/review Prompt</b> - Systematic code quality review using structured methodology (bugs, security, performance, quality)</li>
            <li><b>/explain Prompt</b> - Step-by-step code explanation with real-world usage examples from the codebase</li>
            <li><b>/commit Prompt</b> - Interactive git commit workflow with conventional commit format guidance</li>
        </ul>

        <h4>üîß Qwen CLI Integration</h4>
        <ul>
            <li><b>Auto .env Generation</b> - Automatically creates/updates .env file with OpenAI-compatible credentials from Zest settings</li>
            <li><b>Safe Merge Logic</b> - Preserves existing .env variables while updating Zest-managed ones</li>
            <li><b>SSE Transport</b> - Updated MCP settings.json to use SSE transport for better reliability</li>
            <li><b>Enhanced Documentation</b> - Comprehensive README with slash command examples and usage patterns</li>
        </ul>

        <h4>üåê Tool API Server Restored (OpenWebUI Integration)</h4>
        <ul>
            <li><b>Dual Server Support</b> - MCP Server (port 45450) for Qwen + Tool API Server (ports 8765-8865) for OpenWebUI</li>
            <li><b>Auto-Registration</b> - JavaScript bridge automatically registers tool server with OpenWebUI settings API</li>
            <li><b>Request Interceptor</b> - tool-interceptor.js injects tools into every chat request in Agent Mode</li>
            <li><b>Settings Injector</b> - tool-injector.js persists tools in OpenWebUI settings for long-term availability</li>
            <li><b>OpenAPI 3.1.0 Schema</b> - Auto-generated from langchain4j @Tool annotations</li>
        </ul>

        <h4>üéØ Dual Auto-Binding Architecture</h4>
        <ul>
            <li><b>Settings API Integration</b> - Tools persist in OpenWebUI user settings via REST API</li>
            <li><b>Runtime Injection</b> - fetch() interceptor adds tools to every request dynamically</li>
            <li><b>Tool Server URL</b> - Automatically injected as window.__tool_server_url__ on page load</li>
            <li><b>Agent Mode Only</b> - Tools only active in Agent Mode for focused workflow</li>
        </ul>

        <h4>üìã Developer Experience</h4>
        <ul>
            <li><b>Zero Configuration</b> - Both servers start automatically, no manual setup needed</li>
            <li><b>Separate Tool Instances</b> - MCP and Tool API use independent tool instances to avoid conflicts</li>
            <li><b>Always-On Architecture</b> - Both servers run together for maximum compatibility</li>
            <li><b>Debug Utilities</b> - Browser console helpers for troubleshooting (checkZestToolInjection, debugZestToolInjection)</li>
        </ul>

        <p><em>Complete dual-server architecture with MCP for terminal + Tool API for browser! üöÄ</em></p>

        <h3>Version 1.9.909 - Intelligent Test Generation Overhaul üß™</h3>
        <h4>üß† Project-Aware Test Generation</h4>
        <ul>
            <li><b>Understands Your Codebase:</b> AI analyzes your actual project classes, methods, and dependencies - not just generic patterns from training data</li>
            <li><b>Works for Niche Projects:</b> No longer limited by AI's general knowledge - learns your specific domain, frameworks, and custom libraries</li>
            <li><b>Compile-Ready Output:</b> Generated tests typically compile without errors - AI knows your exact class structures, imports, and types</li>
            <li><b>Smart Context Collection:</b> Optimized strategy gathers only relevant context - faster execution, better results</li>
        </ul>

        <h4>‚ö° Streaming & Performance</h4>
        <ul>
            <li><b>Real-Time Progress:</b> Watch test generation as it happens with streaming updates - know exactly what the AI is doing</li>
            <li><b>Faster Execution:</b> Smarter context gathering reduces processing time significantly</li>
            <li><b>Cancellation Support:</b> Cancel test generation at any time during the process</li>
            <li><b>Better UX:</b> Clear phase indicators, progress feedback, and status updates throughout</li>
        </ul>

        <h4>üéØ Enhanced Context Agent</h4>
        <ul>
            <li><b>Structured Investigation:</b> 3-phase workflow - Planning, Investigation, Validation for thorough analysis</li>
            <li><b>Category-Based Notes:</b> USAGE, ERROR, SCHEMA, INTEGRATION, EDGE_CASE categories for organized findings</li>
            <li><b>Exploration Planning:</b> Smart tool budget management with follow-through rules</li>
            <li><b>Better Tool Selection:</b> Discover via searchCode, Understand via readFile, Analyze via analyzeMethodUsage</li>
        </ul>

        <h4>üîß Test Generation Stability</h4>
        <ul>
            <li><b>Improved File Handling:</b> Better virtual file system integration and test file management</li>
            <li><b>Enhanced Test Merging:</b> Cleaner UI for reviewing and merging generated tests</li>
            <li><b>Ripgrep Security:</b> Fixed command injection vulnerabilities, added regex validation</li>
            <li><b>Comprehensive Testing:</b> 550+ lines of new test coverage for core components</li>
        </ul>

        <h4>üöÄ Additional Improvements</h4>
        <ul>
            <li><b>Pochi CLI Integration:</b> Custom prompt shortcuts with Shift+1-9 for quick actions</li>
            <li><b>Side-by-Side Completion:</b> Compare 2 completion options with syntax highlighting</li>
            <li><b>Lightweight Components:</b> Extracted prompts to .md files, added lightweight JCEF browser</li>
            <li><b>Windows Support:</b> Bundled ripgrep binaries for better cross-platform compatibility</li>
        </ul>

        <p><em>Major focus on making test generation actually understand your specific codebase! üéâ</em></p>
    ]]></change-notes>
</idea-plugin>
